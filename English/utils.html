<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Utils</title>
    <link rel="shortcut icon" href="img/utilities.ico">

    <style>
        body {
            background-color: #909;
        }
    </style>

    <script src="js/jquery.min.js"></script>
    <script src="js/jquery-ui.js"></script>
    <link rel="stylesheet" type="text/css" href="css/jquery-ui.css"/>
</head>

<body>
    <div id="request" style="width:1200px">
        <p id="comment" style="display:inline">Google search address:</p>
        <input type="text" id="googleAddress"></input>
        <input type="button" value="Clean" onclick="document.getElementById('txt').value = googleAddressClean()" id="btnClean"></input>
    </div>
    <div id="result">
        <textarea id="txt" style="width:100%"></textarea>
    </div>

    Now is: <p id="dateTimeNow" style='display: inline'></p>

    <!-- End of body elements -->

    <script src="js/script.js"></script>

    <script>
        (function() {
            var width = $("#request").width();
            // To Do: Hardcoded '33' and '8' - need to be computed automatically
            $("#googleAddress").width(width - $("#comment").width() - $("#btnClean").width() - 33);
            $("#result").width(width - 8);
        })();

        function googleAddressClean() {
            var address = document.getElementById("googleAddress").value;
            var addressPattern = /url=http.*&usg=/;
            var tmp = addressPattern.exec(address);

            var isFullAddress;
            if(tmp == null) {
                tmp = address;
                isFullAddress = true;
            }
            else {
                tmp = tmp.toString();
                isFullAddress = false;
            }

            //
            // http://meyerweb.com/eric/tools/dencoder/
            //
            //tmp = decodeURIComponent(tmp.replace(/\+/g,  " "));
            tmp = decodeURIComponent(tmp);

            if(!isFullAddress) {
                tmp = tmp.slice(4, tmp.length - 5);
            }

            if(tmp.indexOf("%") > 0) {
                tmp = "%%%" + tmp;
            }

            return tmp;
        }

        (function() {
            var d = new Date(Date.now());

            var month = d.getMonth() + 1;
            if (month.toString().length == 1) {
                month = "0" + month;
            }

            var date = d.getDate();
            if (date.toString().length == 1) {
                date = "0" + date;
            }

            var hours = d.getHours();
            if (hours.toString().length == 1) {
                hours = "0" + hours;
            }

            var minutes = d.getMinutes();
            if (minutes.toString().length == 1) {
                minutes = "0" + minutes;
            }

            var seconds = d.getSeconds();
            if (seconds.toString().length == 1) {
                seconds = "0" + seconds;
            }

            var s = "";
            s += d.getFullYear() + "-" + month + "-" + date + "--" + hours + "-" + minutes + "-" + seconds;

            document.getElementById("dateTimeNow").innerHTML = s;
        })();
    </script>
</body>
</html>